<!DOCTYPE html>
<html lang="en" dir="ltr" id="app-html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Universal Workshop">
    <meta name="mobile-web-app-capable" content="yes">
    
    <title>Universal Workshop Mobile</title>
    <meta name="description" content="Universal Workshop ERP Mobile Interface - Arabic & English Support">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/assets/universal_workshop/mobile/manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/universal_workshop/favicon.svg">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/universal_workshop/mobile/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/universal_workshop/mobile/icons/icon-16x16.png">
    <link rel="apple-touch-icon" href="/assets/universal_workshop/mobile/icons/icon-192x192.png">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="/assets/universal_workshop/mobile/css/mobile-app.css" as="style">
    <link rel="preload" href="/assets/universal_workshop/mobile/js/mobile-app.js" as="script">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/universal_workshop/mobile/css/mobile-app.css">
    <link rel="stylesheet" href="/assets/frappe/dist/css/frappe-web.css">
    
    <!-- Arabic Font Support -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-startup-image" href="/assets/universal_workshop/mobile/icons/splash-1125x2436.png">
</head>

<body class="mobile-app-body" id="app-body">
    <!-- Loading Screen -->
    <div id="app-loading" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <img src="/assets/universal_workshop/mobile/icons/icon-192x192.png" alt="Universal Workshop" width="80" height="80">
            </div>
            <div class="loading-text">
                <h3 id="loading-title">Universal Workshop</h3>
                <p id="loading-subtitle">Loading mobile interface...</p>
            </div>
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="mobile-app" class="mobile-app-container" style="display: none;">
        
        <!-- Top Navigation Bar -->
        <nav class="mobile-navbar" id="mobile-navbar">
            <div class="navbar-content">
                <button class="nav-button menu-toggle" id="menu-toggle" aria-label="Menu">
                    <span class="hamburger"></span>
                </button>
                
                <div class="navbar-title">
                    <h1 id="page-title">Dashboard</h1>
                </div>
                
                <div class="navbar-actions">
                    <button class="nav-button notification-btn" id="notification-btn" aria-label="Notifications">
                        <i class="icon-bell"></i>
                        <span class="notification-badge" id="notification-count" style="display: none;">0</span>
                    </button>
                    
                    <button class="nav-button sync-btn" id="sync-btn" aria-label="Sync">
                        <i class="icon-refresh"></i>
                    </button>
                    
                    <button class="nav-button language-toggle" id="language-toggle" aria-label="Language">
                        <span id="language-indicator">EN</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Side Menu -->
        <div class="side-menu" id="side-menu">
            <div class="menu-overlay" id="menu-overlay"></div>
            <div class="menu-content">
                <div class="menu-header">
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">
                            <i class="icon-user"></i>
                        </div>
                        <div class="user-details">
                            <h4 id="user-name">User Name</h4>
                            <p id="user-role">Role</p>
                        </div>
                    </div>
                    <button class="menu-close" id="menu-close" aria-label="Close Menu">
                        <i class="icon-x"></i>
                    </button>
                </div>
                
                <nav class="menu-navigation">
                    <ul class="menu-list" id="menu-list">
                        <!-- Menu items will be populated by JavaScript -->
                    </ul>
                </nav>
                
                <div class="menu-footer">
                    <button class="menu-item logout-btn" id="logout-btn">
                        <i class="icon-log-out"></i>
                        <span data-translate="logout">Logout</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content" id="main-content">
            <!-- Content will be dynamically loaded here -->
        </main>

        <!-- Bottom Navigation (Mobile) -->
        <nav class="bottom-nav" id="bottom-nav">
            <button class="bottom-nav-item active" data-page="dashboard">
                <i class="icon-home"></i>
                <span data-translate="dashboard">Dashboard</span>
            </button>
            <button class="bottom-nav-item" data-page="orders">
                <i class="icon-clipboard"></i>
                <span data-translate="orders">Orders</span>
            </button>
            <button class="bottom-nav-item" data-page="scan">
                <i class="icon-camera"></i>
                <span data-translate="scan">Scan</span>
            </button>
            <button class="bottom-nav-item" data-page="time">
                <i class="icon-clock"></i>
                <span data-translate="time">Time</span>
            </button>
            <button class="bottom-nav-item" data-page="profile">
                <i class="icon-user"></i>
                <span data-translate="profile">Profile</span>
            </button>
        </nav>

        <!-- Floating Action Button -->
        <div class="fab-container" id="fab-container">
            <button class="fab main-fab" id="main-fab" aria-label="Quick Actions">
                <i class="icon-plus"></i>
            </button>
            
            <div class="fab-menu" id="fab-menu">
                <button class="fab fab-action" data-action="scan-barcode" aria-label="Scan Barcode">
                    <i class="icon-barcode"></i>
                </button>
                <button class="fab fab-action" data-action="take-photo" aria-label="Take Photo">
                    <i class="icon-camera"></i>
                </button>
                <button class="fab fab-action" data-action="start-timer" aria-label="Start Timer">
                    <i class="icon-play"></i>
                </button>
                <button class="fab fab-action" data-action="voice-note" aria-label="Voice Note">
                    <i class="icon-microphone"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast-container" id="toast-container">
        <!-- Toast notifications will appear here -->
    </div>

    <!-- Modal Container -->
    <div class="modal-container" id="modal-container">
        <!-- Modals will be dynamically created here -->
    </div>

    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offline-indicator" style="display: none;">
        <i class="icon-wifi-off"></i>
        <span data-translate="offline">You are offline</span>
    </div>

    <!-- Camera Modal -->
    <div class="camera-modal" id="camera-modal" style="display: none;">
        <div class="camera-content">
            <div class="camera-header">
                <h3 data-translate="take_photo">Take Photo</h3>
                <button class="camera-close" id="camera-close">
                    <i class="icon-x"></i>
                </button>
            </div>
            <div class="camera-viewport">
                <video id="camera-video" autoplay playsinline></video>
                <canvas id="camera-canvas" style="display: none;"></canvas>
            </div>
            <div class="camera-controls">
                <button class="camera-btn capture-btn" id="capture-btn">
                    <i class="icon-camera"></i>
                </button>
                <button class="camera-btn switch-btn" id="switch-camera-btn">
                    <i class="icon-rotate-cw"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Barcode Scanner Modal -->
    <div class="scanner-modal" id="scanner-modal" style="display: none;">
        <div class="scanner-content">
            <div class="scanner-header">
                <h3 data-translate="scan_barcode">Scan Barcode</h3>
                <button class="scanner-close" id="scanner-close">
                    <i class="icon-x"></i>
                </button>
            </div>
            <div class="scanner-viewport">
                <div id="scanner-container"></div>
                <div class="scanner-overlay">
                    <div class="scanner-line"></div>
                </div>
            </div>
            <div class="scanner-result" id="scanner-result" style="display: none;">
                <h4 data-translate="scanned_code">Scanned Code:</h4>
                <p id="scanned-value"></p>
                <button class="btn btn-primary" id="use-barcode-btn" data-translate="use_code">Use Code</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/assets/frappe/dist/js/frappe-web.js"></script>
    <script src="/assets/universal_workshop/mobile/js/mobile-app.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/assets/universal_workshop/mobile/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <!-- Translation Data -->
    <script type="application/json" id="translation-data">
        {
            "en": {
                "dashboard": "Dashboard",
                "orders": "Orders",
                "scan": "Scan",
                "time": "Time",
                "profile": "Profile",
                "logout": "Logout",
                "offline": "You are offline",
                "sync": "Sync",
                "take_photo": "Take Photo",
                "scan_barcode": "Scan Barcode",
                "scanned_code": "Scanned Code:",
                "use_code": "Use Code",
                "loading": "Loading...",
                "error": "Error",
                "success": "Success",
                "cancel": "Cancel",
                "save": "Save",
                "delete": "Delete",
                "edit": "Edit",
                "view": "View"
            },
            "ar": {
                "dashboard": "لوحة التحكم",
                "orders": "الطلبات",
                "scan": "مسح",
                "time": "الوقت",
                "profile": "الملف الشخصي",
                "logout": "تسجيل الخروج",
                "offline": "أنت غير متصل",
                "sync": "مزامنة",
                "take_photo": "التقاط صورة",
                "scan_barcode": "مسح الباركود",
                "scanned_code": "الكود الممسوح:",
                "use_code": "استخدام الكود",
                "loading": "جاري التحميل...",
                "error": "خطأ",
                "success": "نجح",
                "cancel": "إلغاء",
                "save": "حفظ",
                "delete": "حذف",
                "edit": "تعديل",
                "view": "عرض"
            }
        }
    </script>

    <!-- App Configuration -->
    <script type="application/json" id="app-config">
        {
            "defaultLanguage": "en",
            "supportedLanguages": ["en", "ar"],
            "apiBaseUrl": "/api/method/universal_workshop.sales_service.mobile_interface",
            "cacheVersion": "1.0.0",
            "features": {
                "offline": true,
                "camera": true,
                "barcode": true,
                "geolocation": true,
                "notifications": true
            },
            "theme": {
                "primaryColor": "#007bff",
                "secondaryColor": "#6c757d",
                "successColor": "#28a745",
                "dangerColor": "#dc3545",
                "warningColor": "#ffc107"
            }
        }
    </script>
</body>
</html> 