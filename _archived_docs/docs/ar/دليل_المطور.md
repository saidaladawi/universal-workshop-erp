# Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ±: ØªØ¬Ù‡ÙŠØ² ÙˆØªØ³Ù„ÙŠÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„
## Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ† Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØ³Ù„ÙŠÙ… Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ø´ Ø§Ù„Ø´Ø§Ù…Ù„

---

## ğŸ“‹ ÙÙ‡Ø±Ø³ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ±](#Ø¥Ø¹Ø¯Ø§Ø¯-Ø¨ÙŠØ¦Ø©-Ø§Ù„ØªØ·ÙˆÙŠØ±)
2. [ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ù„Ù„Ø¹Ù…ÙŠÙ„](#ØªØ­Ø¶ÙŠØ±-Ø§Ù„Ù†Ø³Ø®Ø©-Ù„Ù„Ø¹Ù…ÙŠÙ„)
3. [Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø®ÙŠØµ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø®Øµ](#Ù†Ø¸Ø§Ù…-Ø§Ù„ØªØ±Ø®ÙŠØµ-ÙˆØ¥Ø¯Ø§Ø±Ø©-Ø§Ù„Ø±Ø®Øµ)
4. [Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…Ø®ØµØµ](#Ø¥Ø¹Ø¯Ø§Ø¯-Ø§Ù„ØªØ«Ø¨ÙŠØª-Ø§Ù„Ù…Ø®ØµØµ)
5. [ØªØ®ØµÙŠØµ Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„](#ØªØ®ØµÙŠØµ-Ø§Ù„Ù†Ø¸Ø§Ù…-Ù„Ù„Ø¹Ù…ÙŠÙ„)
6. [Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©](#Ø¥Ø¹Ø¯Ø§Ø¯-Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª-Ø§Ù„Ø£ÙˆÙ„ÙŠØ©)
7. [Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ…](#Ø§Ø®ØªØ¨Ø§Ø±-Ù…Ø§-Ù‚Ø¨Ù„-Ø§Ù„ØªØ³Ù„ÙŠÙ…)
8. [Ø­Ø²Ù…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…](#Ø­Ø²Ù…Ø©-Ø§Ù„ØªØ³Ù„ÙŠÙ…)
9. [Ø§Ù„Ø¯Ø¹Ù… Ø¹Ù† Ø¨ÙØ¹Ø¯](#Ø§Ù„Ø¯Ø¹Ù…-Ø¹Ù†-Ø¨ÙØ¹Ø¯)
10. [Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù†](#Ø§Ù„Ù†Ø³Ø®-Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©-ÙˆØ§Ù„Ø£Ù…Ø§Ù†)

---

## ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ±

### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
```bash
# 1. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„
mkdir -p ~/clients/[CLIENT-NAME]/
cd ~/clients/[CLIENT-NAME]/

# 2. Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
git clone https://github.com/saidaladawi/universal-workshop-erp.git workshop-erp
cd workshop-erp

# 3. Ø¥Ù†Ø´Ø§Ø¡ ÙØ±Ø¹ Ø®Ø§Øµ Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„
git checkout -b client/[CLIENT-NAME]

# 4. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
python3 -m venv env
source env/bin/activate
pip install --upgrade pip

# 5. ØªØ«Ø¨ÙŠØª frappe-bench
pip install frappe-bench

# 6. ØªÙ‡ÙŠØ¦Ø© bench Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„
bench init --frappe-branch version-15 [CLIENT-NAME]-bench
cd [CLIENT-NAME]-bench
```

### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
```bash
# 1. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
bench get-app --branch version-15 erpnext
bench get-app https://github.com/saidaladawi/universal-workshop-erp.git

# 2. Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„
bench new-site [client-domain].local --admin-password [secure-password]

# 3. ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
bench --site [client-domain].local install-app erpnext
bench --site [client-domain].local install-app universal_workshop

# 4. ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ
bench use [client-domain].local
```

---

## ğŸ“¦ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ù„Ù„Ø¹Ù…ÙŠÙ„

### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
```bash
# 1. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„
cat > sites/[client-domain].local/client_config.json << 'EOF'
{
    "client_name": "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„",
    "client_code": "CLIENT-CODE", 
    "license_type": "permanent_full",
    "features": [
        "workshop_management",
        "scrap_management", 
        "arabic_localization",
        "omani_compliance"
    ],
    "deployment_date": "2025-06-22",
    "support_expires": "2026-06-22"
}
EOF

# 2. ØªØ·Ø¨ÙŠÙ‚ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„
bench --site [client-domain].local execute universal_workshop.setup.client_setup \
    --client-config sites/[client-domain].local/client_config.json
```

### ØªØ®ØµÙŠØµ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù„Ù„Ø¹Ù…ÙŠÙ„
```bash
# 1. Ø¥Ù†Ø´Ø§Ø¡ Ø«ÙŠÙ… Ù…Ø®ØµØµ Ù„Ù„Ø¹Ù…ÙŠÙ„
mkdir -p apps/universal_workshop/universal_workshop/public/themes/[client-name]

# 2. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†
cp ~/assets/[client-logo].png apps/universal_workshop/universal_workshop/public/images/
cp ~/assets/[client-theme].css apps/universal_workshop/universal_workshop/public/themes/[client-name]/

# 3. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø«ÙŠÙ…
bench --site [client-domain].local set-config theme [client-name]
bench build --app universal_workshop
```

---

## ğŸ” Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø®ÙŠØµ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø®Øµ

### Ø¥Ù†Ø´Ø§Ø¡ ØªØ±Ø®ÙŠØµ Ø¬Ø¯ÙŠØ¯
```python
# scripts/generate_license.py
#!/usr/bin/env python3

import hashlib
import json
import uuid
from datetime import datetime, timedelta
from cryptography.fernet import Fernet
import base64

class LicenseGenerator:
    def __init__(self):
        # Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (ÙŠØ¬Ø¨ Ø­ÙØ¸Ù‡ Ø¨Ø£Ù…Ø§Ù†)
        self.master_key = "your-secret-master-key-here"
        self.cipher_suite = Fernet(base64.urlsafe_b64encode(
            hashlib.sha256(self.master_key.encode()).digest()
        ))
    
    def generate_hardware_fingerprint(self, client_info):
        """ØªÙˆÙ„ÙŠØ¯ Ø¨ØµÙ…Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"""
        fingerprint_data = {
            "company_name": client_info["company_name"],
            "commercial_register": client_info["commercial_register"],
            "mac_address": client_info.get("mac_address", ""),
            "server_uuid": str(uuid.uuid4())
        }
        
        fingerprint_string = json.dumps(fingerprint_data, sort_keys=True)
        return hashlib.sha256(fingerprint_string.encode()).hexdigest()
    
    def create_license(self, client_info):
        """Ø¥Ù†Ø´Ø§Ø¡ ØªØ±Ø®ÙŠØµ Ø¬Ø¯ÙŠØ¯"""
        license_data = {
            "license_id": f"UW-{datetime.now().year}-{client_info['client_code']}",
            "client_name": client_info["company_name"],
            "client_code": client_info["client_code"],
            "license_type": "permanent_full",
            "features": [
                "workshop_management",
                "scrap_management",
                "arabic_localization", 
                "omani_compliance",
                "unlimited_users",
                "unlimited_vehicles"
            ],
            "issue_date": datetime.now().isoformat(),
            "expires": None,  # Ø¯Ø§Ø¦Ù…
            "hardware_fingerprint": self.generate_hardware_fingerprint(client_info),
            "max_users": -1,  # ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯
            "max_vehicles": -1,  # ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯
            "support_expires": (datetime.now() + timedelta(days=365)).isoformat(),
            "signature": ""
        }
        
        # Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø±Ù‚Ù…ÙŠ
        license_string = json.dumps(license_data, sort_keys=True)
        signature = hashlib.sha256(
            (license_string + self.master_key).encode()
        ).hexdigest()
        
        license_data["signature"] = signature
        
        # ØªØ´ÙÙŠØ± Ø§Ù„ØªØ±Ø®ÙŠØµ
        encrypted_license = self.cipher_suite.encrypt(
            json.dumps(license_data).encode()
        )
        
        return base64.b64encode(encrypted_license).decode()
    
    def validate_license(self, encrypted_license, current_hardware_fingerprint):
        """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªØ±Ø®ÙŠØµ"""
        try:
            # ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±
            encrypted_data = base64.b64decode(encrypted_license.encode())
            decrypted_data = self.cipher_suite.decrypt(encrypted_data)
            license_data = json.loads(decrypted_data.decode())
            
            # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
            signature = license_data.pop("signature")
            license_string = json.dumps(license_data, sort_keys=True)
            expected_signature = hashlib.sha256(
                (license_string + self.master_key).encode()
            ).hexdigest()
            
            if signature != expected_signature:
                return False, "ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ØªØ±Ø®ÙŠØµ ØºÙŠØ± ØµØ­ÙŠØ­"
            
            # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ØµÙ…Ø© Ø§Ù„Ø¬Ù‡Ø§Ø²
            if license_data["hardware_fingerprint"] != current_hardware_fingerprint:
                return False, "Ø§Ù„ØªØ±Ø®ÙŠØµ Ù…Ø±ØªØ¨Ø· Ø¨Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±"
            
            # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¯Ø¹Ù…
            if license_data.get("support_expires"):
                support_expires = datetime.fromisoformat(license_data["support_expires"])
                if datetime.now() > support_expires:
                    return False, "Ø§Ù†ØªÙ‡Øª ÙØªØ±Ø© Ø§Ù„Ø¯Ø¹Ù…"
            
            return True, license_data
            
        except Exception as e:
            return False, f"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ±Ø®ÙŠØµ: {str(e)}"


# Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
if __name__ == "__main__":
    generator = LicenseGenerator()
    
    # Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
    client_info = {
        "company_name": "ÙˆØ±Ø´Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª",
        "client_code": "CLIENT001",
        "commercial_register": "1234567890",
        "mac_address": "00:11:22:33:44:55"
    }
    
    # Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ±Ø®ÙŠØµ
    license_key = generator.create_license(client_info)
    print(f"Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø®ÙŠØµ: {license_key}")
    
    # Ø­ÙØ¸ Ø§Ù„ØªØ±Ø®ÙŠØµ ÙÙŠ Ù…Ù„Ù
    with open(f"license_{client_info['client_code']}.key", "w") as f:
        f.write(license_key)
```

---

## âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…Ø®ØµØµ

### Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªØ«Ø¨ÙŠØª Ù„Ù„Ø¹Ù…ÙŠÙ„
```bash
#!/bin/bash
# client_installer.sh - Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø¹Ù…ÙŠÙ„

# Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
CLIENT_NAME="$1"
CLIENT_CODE="$2" 
CLIENT_DOMAIN="$3"
LICENSE_KEY="$4"

if [ -z "$CLIENT_NAME" ] || [ -z "$CLIENT_CODE" ] || [ -z "$CLIENT_DOMAIN" ] || [ -z "$LICENSE_KEY" ]; then
    echo "Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: $0 <Ø§Ø³Ù…_Ø§Ù„Ø¹Ù…ÙŠÙ„> <ÙƒÙˆØ¯_Ø§Ù„Ø¹Ù…ÙŠÙ„> <Ø§Ù„Ù†Ø·Ø§Ù‚> <Ù…ÙØªØ§Ø­_Ø§Ù„ØªØ±Ø®ÙŠØµ>"
    exit 1
fi

echo "ğŸš— Ø¨Ø¯Ø¡ ØªØ«Ø¨ÙŠØª Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ø´ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„: $CLIENT_NAME"

# Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„
INSTALL_DIR="/opt/universal-workshop-$CLIENT_CODE"
sudo mkdir -p $INSTALL_DIR
cd $INSTALL_DIR

# ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…
echo "ğŸ“¦ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…..."
sudo apt update && sudo apt upgrade -y

# ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
echo "ğŸ”§ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª..."
sudo apt install -y python3 python3-pip python3-venv nodejs npm mariadb-server redis-server nginx supervisor

# Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
echo "ğŸ—„ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..."
sudo mysql -e "CREATE DATABASE ${CLIENT_CODE}_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
sudo mysql -e "CREATE USER '${CLIENT_CODE}_user'@'localhost' IDENTIFIED BY '$(openssl rand -base64 32)';"
sudo mysql -e "GRANT ALL PRIVILEGES ON ${CLIENT_CODE}_db.* TO '${CLIENT_CODE}_user'@'localhost';"
sudo mysql -e "FLUSH PRIVILEGES;"

# ØªØ«Ø¨ÙŠØª frappe-bench
echo "ğŸ—ï¸ ØªØ«Ø¨ÙŠØª frappe-bench..."
sudo pip3 install frappe-bench

# Ø¥Ù†Ø´Ø§Ø¡ bench Ù„Ù„Ø¹Ù…ÙŠÙ„
echo "âš™ï¸ Ø¥Ù†Ø´Ø§Ø¡ bench Ù„Ù„Ø¹Ù…ÙŠÙ„..."
sudo -u frappe bench init --frappe-branch version-15 ${CLIENT_CODE}-bench
cd ${CLIENT_CODE}-bench

# Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
echo "ğŸ“± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª..."
sudo -u frappe bench get-app --branch version-15 erpnext
sudo -u frappe bench get-app https://github.com/saidaladawi/universal-workshop-erp.git

# Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹
echo "ğŸŒ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹..."
sudo -u frappe bench new-site $CLIENT_DOMAIN --admin-password $(openssl rand -base64 16)

# ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
echo "ğŸ”Œ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª..."
sudo -u frappe bench --site $CLIENT_DOMAIN install-app erpnext
sudo -u frappe bench --site $CLIENT_DOMAIN install-app universal_workshop

# ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ
echo "ğŸ” ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ..."
sudo -u frappe bench --site $CLIENT_DOMAIN execute universal_workshop.license.manager.install_license --args "['$LICENSE_KEY']"

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ù†ØªØ§Ø¬
echo "ğŸš€ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ù†ØªØ§Ø¬..."
sudo bench setup production frappe

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
echo "ğŸ’¾ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©..."
(crontab -l 2>/dev/null; echo "0 2 * * * cd $INSTALL_DIR/${CLIENT_CODE}-bench && bench --site $CLIENT_DOMAIN backup --with-files") | crontab -

echo "âœ… ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!"
echo "ğŸŒ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù†Ø¸Ø§Ù… Ø¹Ù„Ù‰: http://$CLIENT_DOMAIN:8000"
```

---

## ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ…

### Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„
```python
# scripts/pre_delivery_test.py

import frappe
import requests
import json
from datetime import datetime
import subprocess

class PreDeliveryTest:
    def __init__(self, site_url, admin_user, admin_password):
        self.site_url = site_url
        self.admin_user = admin_user
        self.admin_password = admin_password
        self.session = requests.Session()
        self.test_results = []
        
    def login(self):
        """ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù†Ø¸Ø§Ù…"""
        try:
            login_data = {
                "usr": self.admin_user,
                "pwd": self.admin_password
            }
            
            response = self.session.post(
                f"{self.site_url}/api/method/login",
                data=login_data
            )
            
            if response.status_code == 200:
                self.log_test("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", True, "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­")
                return True
            else:
                self.log_test("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", False, f"ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: {response.status_code}")
                return False
                
        except Exception as e:
            self.log_test("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", False, f"Ø®Ø·Ø£: {str(e)}")
            return False
    
    def test_basic_functionality(self):
        """Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©"""
        tests = [
            ("Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„", self.test_create_customer),
            ("Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø±ÙƒØ¨Ø©", self.test_create_vehicle),
            ("Ø¥Ù†Ø´Ø§Ø¡ Ø£Ù…Ø± Ø¹Ù…Ù„", self.test_create_work_order),
            ("Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©", self.test_create_invoice),
            ("Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†", self.test_inventory),
            ("Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±", self.test_reports)
        ]
        
        for test_name, test_function in tests:
            try:
                result = test_function()
                self.log_test(test_name, result, "Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¬Ø­" if result else "Ø§Ø®ØªØ¨Ø§Ø± ÙØ§Ø´Ù„")
            except Exception as e:
                self.log_test(test_name, False, f"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: {str(e)}")
    
    def log_test(self, test_name, success, message):
        """ØªØ³Ø¬ÙŠÙ„ Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"""
        self.test_results.append({
            "test": test_name,
            "success": success,
            "message": message,
            "timestamp": datetime.now().isoformat()
        })
        
        status = "âœ…" if success else "âŒ"
        print(f"{status} {test_name}: {message}")
    
    def generate_report(self):
        """Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"""
        total_tests = len(self.test_results)
        passed_tests = len([t for t in self.test_results if t["success"]])
        success_rate = (passed_tests / total_tests) * 100 if total_tests > 0 else 0
        
        report = f"""
=== ØªÙ‚Ø±ÙŠØ± Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ… ===

Ø§Ù„ØªØ§Ø±ÙŠØ®: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
Ø§Ù„Ù…ÙˆÙ‚Ø¹: {self.site_url}

Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª: {total_tests}
- Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø§Ø¬Ø­Ø©: {passed_tests}
- Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©: {total_tests - passed_tests}
- Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: {success_rate:.1f}%

ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:
"""
        
        for test in self.test_results:
            status = "Ù†Ø¬Ø­" if test["success"] else "ÙØ´Ù„"
            report += f"\n- {test['test']}: {status} - {test['message']}"
        
        # Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        with open("pre_delivery_test_report.txt", "w", encoding="utf-8") as f:
            f.write(report)
        
        return success_rate >= 90  # Ù†Ø¬Ø­ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­ 90% Ø£Ùˆ Ø£ÙƒØ«Ø±

    def run_all_tests(self):
        """ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª"""
        print("ğŸ§ª Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ…...")
        
        if not self.login():
            print("âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - ØªÙˆÙ‚Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±")
            return False
        
        # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
        self.test_basic_functionality()
        
        # Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        success = self.generate_report()
        
        if success:
            print("âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø¬Ø­Øª - Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ³Ù„ÙŠÙ…")
        else:
            print("âŒ Ø¨Ø¹Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙØ´Ù„Øª - ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†Ø¸Ø§Ù…")
        
        return success
```

---

## ğŸ“¦ Ø­Ø²Ù…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…

### Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø§Ù„ÙƒØ§Ù…Ù„Ø©
```bash
#!/bin/bash
# create_delivery_package.sh

CLIENT_NAME="$1"
CLIENT_CODE="$2"
CLIENT_DOMAIN="$3"

PACKAGE_DIR="delivery_package_${CLIENT_CODE}_$(date +%Y%m%d)"
mkdir -p $PACKAGE_DIR

echo "ğŸ“¦ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„: $CLIENT_NAME"

# 1. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
mkdir -p $PACKAGE_DIR/documents
cp docs/ar/Ø¯Ù„ÙŠÙ„_ØªØ´ØºÙŠÙ„_Ø§Ù„Ù†Ø¸Ø§Ù….md $PACKAGE_DIR/documents/
cp docs/ar/Ù†Ù…ÙˆØ°Ø¬_Ø§Ù„Ø¹Ù‚Ø¯.md $PACKAGE_DIR/documents/

# 2. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
cat > $PACKAGE_DIR/client_info.txt << EOF
=== Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ===

Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: $CLIENT_NAME
ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„: $CLIENT_CODE
Ø§Ù„Ù†Ø·Ø§Ù‚: $CLIENT_DOMAIN
ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…: $(date '+%Y-%m-%d')

Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:
- Ø§Ù„Ø¥ØµØ¯Ø§Ø±: Universal Workshop ERP v2.0
- Ø§Ù„ØªØ±Ø®ÙŠØµ: Ø¯Ø§Ø¦Ù… ÙˆØ´Ø§Ù…Ù„ + Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø±Ø¯Ø©
- Ø§Ù„Ù…Ù†ØµØ©: ERPNext 15+ / Frappe Framework

Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„:
- Ø§Ù„Ø±Ø§Ø¨Ø·: http://$CLIENT_DOMAIN:8000
- Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: Administrator

Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯Ø¹Ù…:
- Ù‡Ø§ØªÙ: +968 95351993
- Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: support@universal-workshop.om
EOF

# 3. Ø¶ØºØ· Ø§Ù„Ø­Ø²Ù…Ø©
tar -czf ${PACKAGE_DIR}.tar.gz $PACKAGE_DIR/
echo "âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…: ${PACKAGE_DIR}.tar.gz"
```

---

## ğŸ”§ Ø§Ù„Ø¯Ø¹Ù… Ø¹Ù† Ø¨ÙØ¹Ø¯

### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ù† Ø¨ÙØ¹Ø¯
```bash
#!/bin/bash
# setup_remote_access.sh

# ØªØ«Ø¨ÙŠØª SSH server
sudo apt update
sudo apt install openssh-server -y

# ØªÙƒÙˆÙŠÙ† SSH Ù„Ù„Ø£Ù…Ø§Ù†
sudo sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
sudo sed -i 's/#PubkeyAuthentication yes/PubkeyAuthentication yes/' /etc/ssh/sshd_config

# Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¯Ø¹Ù…
sudo useradd -m -s /bin/bash support
sudo mkdir -p /home/support/.ssh
sudo chmod 700 /home/support/.ssh

# Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ø¯Ø¹Ù…
cat > /home/support/.ssh/authorized_keys << 'EOF'
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC... support@universal-workshop.om
EOF

sudo chmod 600 /home/support/.ssh/authorized_keys
sudo chown -R support:support /home/support/.ssh

# Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ SSH
sudo systemctl restart ssh

echo "âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ù† Ø¨ÙØ¹Ø¯"
```

---

## ğŸ¯ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©

### Ù‚Ø§Ø¦Ù…Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø·ÙˆØ±
```
â˜ 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± Ù„Ù„Ø¹Ù…ÙŠÙ„
â˜ 2. Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ±Ø®ÙŠØµ
â˜ 3. ØªØ®ØµÙŠØµ Ø§Ù„Ù†Ø¸Ø§Ù… (Ø§Ù„Ø´Ø¹Ø§Ø±ØŒ Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©)
â˜ 4. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
â˜ 5. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
â˜ 6. ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
â˜ 7. Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…
â˜ 8. ØªÙˆØ«ÙŠÙ‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
â˜ 9. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¯Ø¹Ù… Ø¹Ù† Ø¨ÙØ¹Ø¯
â˜ 10. ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ØªÙ‚Ù†ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„
```

### Ù…Ù„Ù ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
```json
{
    "project_info": {
        "client_name": "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„",
        "client_code": "CLIENT001",
        "start_date": "2025-06-22",
        "estimated_delivery": "2025-09-22",
        "project_manager": "Ø§Ø³Ù… Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"
    },
    "milestones": {
        "planning": {
            "status": "completed",
            "completion_date": "2025-06-29"
        },
        "installation": {
            "status": "in_progress", 
            "estimated_completion": "2025-07-06"
        },
        "customization": {
            "status": "pending",
            "estimated_completion": "2025-07-20"
        },
        "training": {
            "status": "pending",
            "estimated_completion": "2025-08-10"
        },
        "go_live": {
            "status": "pending",
            "estimated_completion": "2025-09-22"
        }
    }
}
```

---

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙŠÙˆÙØ± Ù„Ùƒ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ ÙƒÙ…Ø·ÙˆØ± Ù„ØªØ¬Ù‡ÙŠØ² ÙˆØªØ³Ù„ÙŠÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø´ÙƒÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ ÙˆØ´Ø§Ù…Ù„. ÙƒÙ„ Ù‚Ø³Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª Ø¬Ø§Ù‡Ø²Ø© ÙˆØ¥Ø±Ø´Ø§Ø¯Ø§Øª Ù…ÙØµÙ„Ø© Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©.
